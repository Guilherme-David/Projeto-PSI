<div class="produto">
    <span class="img">
        <img src="{{ produto.imagem }}">
    </span>
    <span class="caption">
        {% if is_admin %}
            <span class="buttons">
                <button class="showhide-editar editar" data-target="editproduto-{{ produto.id }}">
                    &#x270F;
                </button>
            </span>
        {% endif %}
        <span class="infos">
            {% set preco = produto.preco|float(0) %}
            <p class="produtonome">{{ produto.nome }}</p>
            <p class="produtopreço">
                R$ {{ "{:,.2f}".format(preco).replace(",", "X").replace(".", ",").replace("X", ".") }}
            </p>
            {% if not is_admin %}
                <span class="finalizar">
                    <form method="post" action="{{ url_for('adicionar_sacola', produto_id=produto.id) }}">
                        <button type="submit" class="adicionar-sacola">
                            <svg viewBox="0 0 20 20"><path d="M7.5,7.5V4A2.48,2.48,0,0,1,10,1.5,2.54,2.54,0,0,1,12.5,4V7.5"></path><polygon points="16.5 7.5 3.5 7.5 2.5 18.5 17.5 18.5 16.5 7.5"></polygon></svg> Adicionar
                        </button>
                        <input type="number" name="quantidade" value="1" min="1" required>
                    </form>
                </span>
            {% endif %}
        </span>

        {% if is_admin %} 
            <span class="buttons">
                <form method="post" action="{{ url_for('remover', item=produto.id) }}">
                    <button type="submit" onclick="return confirm('Deseja mesmo remover este item?')" class="remover">
                        &#128465;
                    </button>
                </form>
            </span>
        {% endif %}
    </span>
</div>

<div id="editproduto-{{ produto.id }}" class="overlay hide">
    <div class="popup-editar">
        <span class="popup-header">
            <h2> Eidtar Produto</h2>
            <button class="showhide-close" data-target="editproduto-{{ produto.id }}">&times;</button>
        </span>
        <form method="post" action="{{ url_for('editar', item=produto.id)  }}">
            <label> Nome do produto: </label>
            <input type="text" name="nome" value=" {{ produto.nome }}">
            <label> Preço produto: </label>
            <input type="text" name="preco"  value = "{{ produto.preco }}" ">
            <label> </label>
            <select name="categoria"> 
                <option value="hamburguers" {% if produto.categoria == 'hamburguers' %}selected{% endif %}>Hambúrgueres</option>
                <option value="sobremesas" {% if produto.categoria == 'sobremesas' %}selected{% endif %}>Sobremesas</option>
                <option value="bebidas" {% if produto.categoria == 'bebidas' %}selected{% endif %}>Bebidas</option>
            </select>
            <label> Imagem do Produto(URL): </label>
            <input type="url" name="url" value="{{ produto.imagem }}">
            <button type="submit"> Editar </button>
        </form>
    </div>
</div>

<script>
    document.querySelectorAll('.showhide-editar').forEach(button => {
        button.addEventListener('click', () => {
            const targetId = button.getAttribute('data-target');
            const container = document.getElementById(targetId);
            container.classList.remove('hide'); 
        });
    });

    document.querySelectorAll('.showhide-close').forEach(button => {
    button.addEventListener('click', () => {
        const overlay = button.closest('.overlay'); 
        overlay.classList.add('hide');
    });
});
</script>